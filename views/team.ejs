<form enctype="multipart/form-data" action="/team">
    <h2>Add Team</h2>

    <lable for="teamName">teamName</lable>
    <input type="text" name="teamName"/>
    <div class="teamName error"></div>

    <label for="teamImage">Team Image</label>
    <input type="file" name="teamImage" />
    <div class="teamImage error"></div>
    
    <lable for="squadSize">squadSize</lable>
    <input type="text" name="squadSize"/>
    <div class="squadSize error"></div>

    <lable for="marketValue">marketValue</lable>
    <input type="text" name="marketValue"/>
    <div class="marketValue error"></div>

    <lable for="transferRecord">transferRecord</lable>
    <input type="text" name="transferRecord"/>
    <div class="transferRecord error"></div>

    <lable for="avgPlayerValue">avgPlayerValue</lable>
    <input type="text" name="avgPlayerValue"/>
    <div class="avgPlayerValue error"></div>

    <lable for="avgAge">avgAge</lable>
    <input type="text" name="avgAge"/>
    <div class="avgAge error"></div>

    <button type="submit">Add team</button>
    
    
</form>

<script>
    const form = document.querySelector('form');
    // read the error
    const teamImageError = document.querySelector('.teamImage.error');
    const teamNameError = document.querySelector('.teamName.error');
    const squadSizeError = document.querySelector('.squadSize.error');
    const marketValueError = document.querySelector('.marketValue.error');
    const transferRecordError = document.querySelector('.transferRecord.error');
    const avgPlayerValueError = document.querySelector('.avgPlayerValue.error');
    const avgAgeError = document.querySelector('.avgAge.error');

    form.addEventListener('submit', async (e) => {
        e.preventDefault();
        //reset errors
        teamImageError.textContent = '';
        teamNameError.textContent = '';
        squadSizeError.textContent = '';
        marketValueError.textContent = '';
        transferRecordError.textContent = '';
        avgPlayerValueError.textContent = '';
        avgAgeError.textContent = '';

        // Create a FormData instance
        const formData = new FormData();
        formData.append('avgAge', form.avgAge.value);
        formData.append('teamName', form.teamName.value);
        formData.append('squadSize', form.squadSize.value);
        formData.append('marketValue', form.marketValue.value);
        formData.append('transferRecord', form.transferRecord.value);
        formData.append('avgPlayerValue', form.avgPlayerValue.value);
        if (form.teamImage.files.length > 0) {
          formData.append('teamImage', form.teamImage.files[0]);
        }

        console.log(formData);
        
        try{
            const res = await fetch('/team', {
                method: 'POST',
                body: formData, // Send the form data
            });
            const data = await res.json();
            console.log(data);

            if (data.errors){
                teamImageError.textContent = data.errors.teamImage
                teamNameError.textContent = data.errors.teamName
                squadSizeError.textContent = data.errors.squadSize
                marketValueError.textContent = data.errors.marketValue
                transferRecordError.textContent = data.errors.transferRecord
                avgPlayerValueError.textContent = data.errors.avgPlayerValue
                avgAgeError.textContent = data.errors.avgAge
            }
            else{
                descriptionError.textContent = ('Added successfully');
            }
        }
        catch (err){
            console.log(err);
        }
    });
</script>
